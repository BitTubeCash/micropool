<!DOCTYPE html>
<html>
	<head>
        <meta charset="UTF-8">
		<link rel="stylesheet" href="resources/custom.css">
		<link rel="stylesheet" href="resources/css/fa.css">
		<script>
			function openTab(evt, cityName) {
				var i, tabcontent, tablinks;

				tabcontent = document.getElementsByClassName("tabcontent");
				for (i = 0; i < tabcontent.length; i++) {
					tabcontent[i].style.display = "none";
				}

				tablinks = document.getElementsByClassName("tablinks");
				for (i = 0; i < tablinks.length; i++) {
					tablinks[i].className = tablinks[i].className.replace(" active", "");
				}

				document.getElementById(cityName).style.display = "block";
				evt.currentTarget.className += " active";
			}
		</script>
		<style>
			.tab {
				overflow: hidden;
			}

			.tab button {
				float: left;
				border: none;
				outline: none;
				cursor: pointer;
				padding: 14px 16px;
				transition: 0.3s;
			}

			.tab button:hover {
			}

			.tab button.active {
			}

			.tabcontent {
				height:calc(100% - 290px);
				display: none;
				padding: 0px 0px;
			}
		</style>
	</head>
	<body onload="openTab(event,'tablog')">
		<div id="body">
			<table style="margin-top:20px;margin-bottom:20px;width:100%;table-layout: fixed;border:0;" cellspacing="0" cellpadding="0">
				<colgroup>
					<col span="1" style="width: 33%;">
					<col span="1" style="width: 34%;">
					<col span="1" style="width: 33%;">
				</colgroup>
				<tr>
					<td colspan="3">
						<table style="width:100%;table-layout: fixed;border:0;" cellspacing="0" cellpadding="0">
							<colgroup>
								<col style="width: 125px">
								<col style="width: *">
							</colgroup>
							<tr>
								<td><i class="fas fa-wallet fa-lg fa-fw"></i>&ensp;Wallet</td>
								<td>
									<input id="mining_address" value="" onchange="updateData()" style="width:calc(100% - 12px)" type="text"/>
								</td>
							</tr>
						</table>
					</td>
				</tr>
				<tr>
					<td>
						<table style="margin-top:20px;width:100%;table-layout: fixed;border:0;" cellspacing="0" cellpadding="0">
							<colgroup>
								<col style="width: 125px">
								<col style="width: *">
							</colgroup>
							<tr>
								<td><i class="fas fa-server fa-lg fa-fw"></i>&ensp;Daemon-Host</td>
								<td>
									<input id="daemonhost" value=""style="width:100%" onchange="updateData()" type="text"/>
								</td>
							</tr>
						</table>
					</td>
					<td>
						<table style="padding-left:20px;margin-top:20px;width:100%;table-layout: fixed;border:0;" cellspacing="0" cellpadding="0">
							<colgroup>
								<col style="width: 93px">
								<col style="width: *">
							</colgroup>
							<tr>
								<td><i class="fas fa-users fa-lg fa-fw"></i>&ensp;Workers</td>
								<td class="data">
									<input disabled="true" id="data_conn" style="width:100%" type="text"/>
								</td>
							</tr>
						</table>
					</td>
					<td>
						<table style="padding-left:20px;margin-top:20px;width:100%;table-layout: fixed;border:0;" cellspacing="0" cellpadding="0">
							<colgroup>
								<col style="width: 118px">
								<col style="width: *">
							</colgroup>
							<tr>
								<td><i class="fas fa-tachometer-alt fa-lg fa-fw"></i>&ensp;GPS</td>
								<td class="data">
									<input disabled="true" id="data_gps" style="width:calc(100% - 12px)" type="text"/>
								</td>
							</tr>
						</table>
					</td>
				</tr>

				<tr>
					<td>
						<table style="margin-top:20px;width:100%;table-layout: fixed;border:0;" cellspacing="0" cellpadding="0">
							<colgroup>
								<col style="width: 125px">
								<col style="width: *">
							</colgroup>
							<tr>
								<td><i class="fas fa-phone-volume fa-lg fa-fw"></i>&ensp;Daemon-Port</td>
								<td>
									<input id="daemonport" value="" onchange="updateData()" style="width:100%" type="text"/>
								</td>
							</tr>
						</table>
					</td>
					<td>
						<table style="padding-left:20px;margin-top:20px;width:100%;table-layout: fixed;border:0;" cellspacing="0" cellpadding="0">
							<colgroup>
								<col style="width: 93px">
								<col style="width: *">
							</colgroup>
							<tr>
								<td><i class="fas fa-bars fa-lg fa-fw"></i>&ensp;Height</td>
								<td class="data">
									<input disabled="true" id="data_height" style="width:100%" type="text"/>
								</td>
							</tr>
						</table>
					</td>
					<td>
						<table style="padding-left:20px;margin-top:20px;width:100%;table-layout: fixed;border:0;" cellspacing="0" cellpadding="0">
							<colgroup>
								<col style="width: 118px">
								<col style="width: *">
							</colgroup>
							<tr>
								<td><i class="fas fa-clone fa-lg fa-fw"></i>&ensp;Shares</td>
								<td class="data">
									<input disabled="true" id="data_shares" style="width:calc(100% - 12px)" type="text"/>
								</td>
							</tr>
						</table>
					</td>
				</tr>

				<tr>
					<td>
						<table style="margin-top:20px;width:100%;table-layout: fixed;border:0;" cellspacing="0" cellpadding="0">
							<colgroup>
								<col style="width: 125px">
								<col style="width: *">
							</colgroup>
							<tr>
								<td><i class="fas fa-phone-volume fa-lg fa-fw"></i>&ensp;Pool-Port</td>
								<td>
									<input id="poolport" value="" onchange="updateData()" style="width:100%" type="text"/>
								</td>
							</tr>
						</table>
					</td>
					<td>
						<table style="padding-left:20px;margin-top:20px;width:100%;table-layout: fixed;border:0;" cellspacing="0" cellpadding="0">
							<colgroup>
								<col style="width: 93px">
								<col style="width: *">
							</colgroup>
							<tr>
								<td><i class="fas fa-unlock fa-lg fa-fw"></i>&ensp;Difficutly</td>
								<td class="data">
									<input disabled="true" id="data_diff" style="width:100%" type="text"/>
								</td>
							</tr>
						</table>
					</td>
					<td>
						<table style="padding-left:20px;margin-top:20px;width:100%;table-layout: fixed;border:0;" cellspacing="0" cellpadding="0">
							<colgroup>
								<col style="width: 118px">
								<col style="width: *">
							</colgroup>
							<tr>
								<td><i class="fas fa-cubes fa-lg fa-fw"></i>&ensp;Blocks found</td>
								<td class="data">
									<input disabled="true" value="0" id="data_blocks" style="width:calc(100% - 12px)" type="text"/>
								</td>
							</tr>
						</table>
					</td>
				</tr>
			</table>

			<div class="tab">
			<button class="tablinks" onclick="openTab(event, 'tablog')">Log</button>
			<button class="tablinks" onclick="openTab(event, 'tabworker')">Worker</button>
			<button class="tablinks" onclick="openTab(event, 'tabblocks')">Blocks</button>
			</div>

			<div id="tablog" class="tabcontent">
				<div id="log" style="overflow:hidden;padding:5px;height:100%">
				</div>
			</div>

			<div id="tabworker" class="tabcontent">
				w
			</div>

			<div id="tabblocks" class="tabcontent">
				b
			</div>

		</div>
		<script>
			var electron = require('electron');
			var loglines = [];
			function updateData() { 
			
				if( (document.getElementById('daemonport').value < 1024)||(document.getElementById('daemonport').value > 65535))
					document.getElementById('daemonport').value=19950;
				if( (document.getElementById('poolport').value < 1024)||(document.getElementById('poolport').value > 65535))
					document.getElementById('poolport').value=14650;
				
				ipcRenderer.send('set', ['daemonport',parseFloat(document.getElementById('daemonport').value)|0]);
				ipcRenderer.send('set', ['poolport',parseFloat(document.getElementById('poolport').value)|0]);
				ipcRenderer.send('set', ['daemonhost',document.getElementById('daemonhost').value]);
				ipcRenderer.send('set', ['mining_address',document.getElementById('mining_address').value]);
			}
			const { ipcRenderer } = require('electron')
			ipcRenderer.send('get', 'daemonport');
			ipcRenderer.send('get', 'poolport');
			ipcRenderer.send('get', 'daemonhost');
			ipcRenderer.send('get', 'mining_address');
			
			ipcRenderer.on('get-reply', (event, arg) => {
				document.getElementById(arg[0]).value=arg[1];
			})
			ipcRenderer.on('log', (event, msg) => {
				var d = new Date();
				loglines.unshift(d.toISOString()+' <span>['+msg[0]+']</span> '+msg[1]);
				if (loglines.length > 100) loglines.pop();
				document.getElementById('log').innerHTML=loglines.join('<br/>');
			});
		</script>
	</body>
</html>
